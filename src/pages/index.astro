---
import SVG from '@components/StyledSVG.astro';
import BasicPageLayout from '@layouts/BasicPageLayout.astro';
import SplashDecoration from '@components/SplashDecoration.astro';
import Menu from '@components/Menu.astro';
import { theme } from '@root/tailwind.config';

import codeGif from '@images/code.gif';
import blogGif from '@images/blog.gif';
import squiggleGif from '@images/squiggle.gif';

import '@styles/glitch.css';

const indexOptions = {
  blog: {
    link: '/blog',
    style: '',
    font: 'font-handwriting',
    gif: blogGif.src
  },
  projects: {
    link: '/projects',
    style: '',
    font: 'font-code',
    gif: codeGif.src
  },
}
---
<style>
  @keyframes fadeout {
    0% {
      opacity: 1;
    }
    100% {
      opacity: 0;
    }
  }
  @keyframes fadein {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }
</style>

<script define:vars={{indexOptions, theme, squiggleGif}}>
  const glitchEffect = "hero glitch layers deform".split(' ');
  document.addEventListener('DOMContentLoaded', () => {
    const SVGLogoElement = document.getElementById('header-logo');
    const menuElement = document.getElementById('index-menu');
    const glitchTextElement = document.getElementById('glitch-text');
    const listElements = [...menuElement.getElementsByTagName('li')];

    SVGLogoElement.style.visibility = 'hidden';
    glitchEffect.forEach(effect => {
      glitchTextElement.classList.add(effect);
    });
    glitchTextElement.classList.add('font-abstract')

    const previousResizeListener = window.onresize;
    document.addEventListener('resize', () => {
      previousResizeListener && previousResizeListener();
    });

    listElements.forEach(element => {
      const matchingFont = indexOptions[element.innerText.toLowerCase()].font;
      const splashGifImage = document.getElementById('splash-gif');
      const originalGifSource = splashGifImage.src;

      element.onmouseenter = () => {
        glitchTextElement.classList.remove('font-abstract')
        glitchTextElement.classList.add(matchingFont);
        splashGifImage.src = indexOptions[element.innerText.toLowerCase()].gif;
      };

      element.onmouseleave = () => {
        glitchTextElement.classList.remove(matchingFont);
        glitchTextElement.classList.add('font-abstract')
        splashGifImage.src = originalGifSource;
      };
    });
  });
</script>

<BasicPageLayout 
  title="Kamil Rybacki"
  style="flex flex-col justify-center items-center overflow-hidden"
>
  <div class="flex flex-col-reverse lg:flex-row lg:justify-around justify-center items-center my-auto lg:w-full lg:py-12">
    <SplashDecoration
      className="invert grayscale"
    />
    <div class="mt-4 flex flex-col lg:gap-3 gap-1 justify-end items-center w-fit mx-auto lg:mr-auto my-auto flex flex-col items-end z-1" id="menu-wrapper">
      <div class="flex flex-row lg:mt-12">
        <div class="relative flex lg:justify-end w-16 lg:w-40 text-accent">
          <SVG src="images/logo" alt="Logo"/>
        </div>
        <h1 class="relative lg:top-12 top-2 lg:text-8xl text-[2.25rem] font-body font-[700]">
          amil Rybacki
        </h1>
      </div>
      <div class="border-[1px] border-accent my-3 lg:mb-4 lg:mt-6 w-[105%] opacity-50"/>
      <h2 class="relative flex flex-row items-center text-xl lg:text-4xl lg:mt-2 mx-auto lg:ml-0 lg:mr-auto font-body font-[500] text-accent gap-3 lg:gap-4">
        <span class="my-auto py-auto">
          Figuring out
        </span>
        <span
          class="flex px-auto py-auto tracking-widest my-auto lg:w-64"
          data-text="undefineds"
          id="glitch-text"
        >
          undefineds
        </span>
      </h2>
      <Menu
        options={indexOptions}
        style='lg:h-36 relative flex flex-row-reverse gap-8 lg:gap-12 text-3xl lg:text-6xl font-bold mt-6 lg:mt-10 items-center justify-center'
        globalListStyle="relative bg-background my-auto z-99 transition-all duration-[500ms] ease-in-out hover:-translate-y-2 lg:hover:-translate-y-5 hover:cursor-pointer"
        id="index-menu"
      />
    </div>
  </div>
</BasicPageLayout>
